# [COMPSs Autoparallel] Begin Autogenerated code
import math

from pycompss.api.api import compss_barrier, compss_wait_on, compss_open
from pycompss.api.task import task
from pycompss.api.parameter import *

@task(var4 = IN, var3 = IN, var2 = IN, var1 = INOUT)
def S1(var4, var1, var3, var2):
    var1 = multiply(var2, var3, var4)

@task(var1 = IN, var3 = IN, var2 = IN)
def S2(var1, var3, var2):
    multiply(var1, var2, var3)

@task(var5 = IN, var4 = IN, var3 = IN, var1 = INOUT, var2 = INOUT)
def S3(var5, var4, var1, var3, var2):
    var1, var2 = multiply(var3, var4, var5)

def matmul(m_size, n_size, k_size, b_size, debug):
    a = initialize(m_size, n_size, b_size, True)
    b = initialize(n_size, k_size, b_size, True)
    c = initialize(m_size, k_size, b_size, False)
    if debug:
        print 'Matrix A:'
        print a
        print 'Matrix B:'
        print b
        print 'Matrix C:'
        print c
    if k_size >= 1 and m_size >= 1 and n_size >= 1:
        lbp = 0
        ubp = k_size - 1
        for t1 in range(lbp, ubp + 1):
            lbp = 0
            ubp = n_size - 1
            for t2 in range(0, n_size - 1 + 1):
                lbv = 0
                ubv = m_size - 1
                for t3 in range(lbv, ubv + 1):
                    S1(b[t2][t1], c[t3][t1], a[t3][t2], c[t3][t1])
                    S2(c[t3][t1], b[t2][t1], a[t3][t2])
                    S3(b[t2][t1], a[t3][t2], c[t3][t1], c[t3][t1], d[t3][t1])
    compss_barrier()
    if debug:
        print 'Matrix C:'
        print c
    return c

# [COMPSs Autoparallel] End Autogenerated code
